/*This code was automatically generated by automatic_src/make_newton_genotypic_correl.py*/
#ifndef _NEWTON_REL_
#define _NEWTON_REL_


#include "genotype_pair.h"
#include "relatedness_data.h"

inline float_t H0 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H1 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H2 (const Genotype_pair &pair, const Relatedness &rel) {
	return (4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H3 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H4 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H5 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t H6 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)))
;
}

inline float_t J00 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J01 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J02 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J03 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J04 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J05 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J06 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J10 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J11 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J12 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J13 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J14 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J15 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J16 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) + pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J20 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J21 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J22 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J23 (const Genotype_pair &pair, const Relatedness &rel) {
	return (4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J24 (const Genotype_pair &pair, const Relatedness &rel) {
	return (4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J25 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J26 (const Genotype_pair &pair, const Relatedness &rel) {
	return (4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) + pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J30 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J31 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J32 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J33 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J34 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J35 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J36 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J40 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J41 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J42 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J43 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J44 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J45 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J46 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))*(-2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J50 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J51 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J52 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J53 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J54 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J55 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J56 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) + pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) + pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J60 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_Mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J61 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) + 2*pair.X_MM*pair.Y_Mm*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_mm*pair.m*pow(-pair.m + 1, 3) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 3)*(-pair.m + 1) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 3)*(-pair.m + 1) - pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J62 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-4*pair.X_MM*pair.Y_MM*pair.m*pow(-pair.m + 1, 3) - pair.X_MM*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) + 4*pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_Mm*pair.Y_MM*pair.m*(-pair.m + 1)*(4*pair.m*(-pair.m + 1) - 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(4*pow(pair.m, 2) - 4*pair.m*(-2*pair.m + 2) + 4*pow(-pair.m + 1, 2)) - pair.X_Mm*pair.Y_mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) + 4*pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_Mm*pair.m*(-pair.m + 1)*(-4*pow(pair.m, 2) + 4*pair.m*(-pair.m + 1)) - 4*pair.X_mm*pair.Y_mm*pow(pair.m, 3)*(-pair.m + 1))*(pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J63 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 2*pair.X_MM*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_MM*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J64 (const Genotype_pair &pair, const Relatedness &rel) {
	return (pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))*(2*pair.X_MM*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_MM*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*pair.X_MM*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 2*pair.X_mm*pair.Y_MM*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0) + 4*pair.X_mm*pair.Y_Mm*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*pair.X_mm*pair.Y_mm*pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J65 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_MM*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_MM*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_Mm*pair.Y_MM*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_Mm*pair.Y_Mm*(-12.0 + 4.0/(-pair.m + 1) + 4.0/pair.m) - pair.X_Mm*pair.Y_mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_MM*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pair.X_mm*pair.Y_Mm*(6.0 - 2.0/(-pair.m + 1) - 2.0/pair.m) - pair.X_mm*pair.Y_mm*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m))*(pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t J66 (const Genotype_pair &pair, const Relatedness &rel) {
	return (-pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))*(pair.X_MM*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_MM*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_MM*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) + 4*pair.X_Mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_Mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_MM*pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.X_mm*pair.Y_Mm*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.X_mm*pair.Y_mm*pow(pair.m, 2)*pow(-pair.m + 1, 2))/pow(pair.X_MM*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*pow(-pair.m + 1, 3)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + pow(-pair.m + 1, 4)) + pair.X_MM*pair.Y_Mm*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_X_*(-pair.m + 1) - 2*rel.f_Y_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_X_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_Y_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_MM*(-2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 2*pair.m*pow(-pair.m + 1, 3) + pair.m*(-pair.m + 1)*(2*pair.m*rel.f_Y_*(-pair.m + 1) - 2*rel.f_X_*pow(-pair.m + 1, 2) - 4*rel.theta_XY_*(-pair.m*(-pair.m + 1) + pow(-pair.m + 1, 2))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_Mm*(4*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + 4*pow(pair.m, 2)*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-4*pair.m*rel.f_X_*(-pair.m + 1) - 4*pair.m*rel.f_Y_*(-pair.m + 1) + 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-2*pair.m + 2) + pow(-pair.m + 1, 2))) + 4*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_X_ + 2*pair.m*rel.f_Y_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) - 4*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pow(pair.m, 2)*pow(-pair.m + 1, 2) - 2*pair.m*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0) + pair.m*(-pair.m + 1)*(pow(pair.m, 2)*rel.f_Y_ - 4*pair.m*rel.theta_XY_*(-pair.m + 1) + rel.f_X_*pow(-pair.m + 1, 2)) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*(-2*pair.m + 2) - 2*pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) + pair.m*(-pair.m + 1)*(-2*pow(pair.m, 2)*rel.f_Y_ + 2*pair.m*rel.f_X_*(-pair.m + 1) - 4*rel.theta_XY_*(pow(pair.m, 2) - pair.m*(-pair.m + 1))) - 2*rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m) + 2*rel.gamma_XY_*pow(pair.m*(-pair.m + 1), -0.5)*(2*pair.m - 1)*(2.0*pair.m - 1.0) - 4*rel.gamma_YX_*pow(pair.m*(-pair.m + 1), -0.5)*(-2*pair.m + 1)*(2.0*pair.m - 1.0)) + pair.X_mm*pair.Y_mm*(pow(pair.m, 4) + pow(pair.m, 3)*(-pair.m + 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m, 2)*rel.Delta_XY_*pow(-pair.m + 1, 2) - pair.m*pow(pair.m*(-pair.m + 1), -0.5)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*(-3.0 + 1.0/(-pair.m + 1) + 1.0/pair.m)), 2)
;
}

inline float_t lnL_NR (const Genotype_pair &pair, const Relatedness &rel) {
	return log(pow(-pair.m*(pair.m - 1), -0.5)*(pair.X_MM*pair.Y_MM*(pair.m*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 3)*(pow(pair.m, 2)*rel.Delta_XY_ - pair.m*(pair.m - 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) + pow(pair.m - 1, 2)) + 2*pair.m*pow(pair.m - 1, 2)*(2.0*pair.m - 1.0)*(rel.gamma_XY_ + rel.gamma_YX_) - rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) - 2*pair.X_MM*pair.Y_Mm*(pow(pair.m, 2)*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 3)*(pair.m*rel.Delta_XY_ - pair.m*rel.f_X_ + pair.m - rel.f_Y_*(pair.m - 1) - 2*rel.theta_XY_*(2*pair.m - 1) - 1) + pair.m*(pair.m - 1)*(2*pair.m - 1)*(2.0*pair.m - 1.0)*(rel.gamma_XY_ + 2*rel.gamma_YX_) - rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) - pair.X_MM*pair.Y_mm*(pow(pair.m, 2)*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 2)*(pow(pair.m, 2)*rel.f_X_ - pair.m*rel.Delta_XY_*(pair.m - 1) + 4*pair.m*rel.theta_XY_*(pair.m - 1) - pair.m*(pair.m - 1) + rel.f_Y_*pow(pair.m - 1, 2)) + 2*pair.m*(pair.m - 1)*(2.0*pair.m - 1.0)*(pair.m*rel.gamma_YX_ + rel.gamma_XY_*(pair.m - 1)) + rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) - 2*pair.X_Mm*pair.Y_MM*(pow(pair.m, 2)*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 3)*(pair.m*rel.Delta_XY_ - pair.m*rel.f_Y_ + pair.m - rel.f_X_*(pair.m - 1) - 2*rel.theta_XY_*(2*pair.m - 1) - 1) + pair.m*(pair.m - 1)*(2*pair.m - 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + rel.gamma_YX_) - rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) + 4*pair.X_Mm*pair.Y_Mm*(pow(pair.m, 2)*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 2)*(pair.m*rel.Delta_XY_*(pair.m - 1) - pair.m*rel.f_X_*(pair.m - 1) - pair.m*rel.f_Y_*(pair.m - 1) + pair.m*(pair.m - 1) - rel.theta_XY_*(pow(pair.m, 2) + 2*pair.m*(pair.m - 1) + pow(pair.m - 1, 2))) + pair.m*(pair.m - 1)*(2*pair.m - 1)*(2.0*pair.m - 1.0)*(-rel.gamma_XY_ + rel.gamma_YX_) - rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) + 2*pair.X_Mm*pair.Y_mm*(pow(pair.m, 3)*sqrt(-pair.m*(pair.m - 1))*(pair.m - 1)*(pair.m*(-pair.m + 1) - rel.Delta_XY_*pow(pair.m - 1, 2) + (pair.m - 1)*(pair.m*rel.f_X_ + rel.f_Y_*(pair.m - 1) + 2*rel.theta_XY_*(2*pair.m - 1))) + pair.m*(pair.m - 1)*(2*pair.m - 1)*(2.0*pair.m - 1.0)*(2*rel.gamma_XY_ + rel.gamma_YX_) + rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) - pair.X_mm*pair.Y_MM*(pow(pair.m, 2)*sqrt(-pair.m*(pair.m - 1))*pow(pair.m - 1, 2)*(pow(pair.m, 2)*rel.f_Y_ - pair.m*rel.Delta_XY_*(pair.m - 1) + 4*pair.m*rel.theta_XY_*(pair.m - 1) - pair.m*(pair.m - 1) + rel.f_X_*pow(pair.m - 1, 2)) + 2*pair.m*(pair.m - 1)*(2.0*pair.m - 1.0)*(pair.m*rel.gamma_XY_ + rel.gamma_YX_*(pair.m - 1)) + rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) + 2*pair.X_mm*pair.Y_Mm*(pow(pair.m, 3)*sqrt(-pair.m*(pair.m - 1))*(pair.m - 1)*(pair.m*(-pair.m + 1) - rel.Delta_XY_*pow(pair.m - 1, 2) + (pair.m - 1)*(pair.m*rel.f_Y_ + rel.f_X_*(pair.m - 1) + 2*rel.theta_XY_*(2*pair.m - 1))) + pair.m*(pair.m - 1)*(2*pair.m - 1)*(2.0*pair.m - 1.0)*(rel.gamma_XY_ + 2*rel.gamma_YX_) + rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)) - pair.X_mm*pair.Y_mm*(pow(pair.m, 3)*sqrt(-pair.m*(pair.m - 1))*(pair.m - 1)*(-pow(pair.m, 2) + pair.m*(pair.m - 1)*(rel.f_X_ + rel.f_Y_ + 4*rel.theta_XY_) - rel.Delta_XY_*pow(pair.m - 1, 2)) + 2*pow(pair.m, 2)*(pair.m - 1)*(2.0*pair.m - 1.0)*(rel.gamma_XY_ + rel.gamma_YX_) + rel.delta_XY_*sqrt(-pair.m*(pair.m - 1))*(3.0*pair.m*(pair.m - 1) + 1.0)))/(pair.m*(pair.m - 1)))
;
}

#endif
