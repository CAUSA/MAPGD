/*This code was automatically generated by make_newton_theta.py*/

#include "allele_stat.h"
#include "quartet.h"
#include "typedef.h"

inline float_t H0 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t H1 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t H2 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t J00 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 2.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(2*a.freq)/pow(exp(a.freq) + 1.0, 3) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 2.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(2*a.freq)/pow(exp(a.freq) + 1.0, 3) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)) - 2.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(2*a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 3)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0)) + (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))*(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2)
;
}

inline float_t J01 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.error)*exp(a.freq)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.error)*exp(a.freq)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)*exp(a.freq)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0)) + (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))*(0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) - 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2)
;
}

inline float_t J02 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))*(-1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2) + (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*exp(a.f)*exp(a.freq)/(pow(exp(a.f) + 1.0, 2)*pow(exp(a.freq) + 1.0, 2)) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.f)*exp(a.freq)/(pow(exp(a.f) + 1.0, 2)*pow(exp(a.freq) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t J10 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.error)*exp(a.freq)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.error)*exp(a.freq)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)*exp(a.freq)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*pow(exp(a.freq) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.freq)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0)) + (1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))*(-0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2)
;
}

inline float_t J11 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (0.0277777777777778*pow(E, 2)*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*pow(6.0*exp(a.error) + 6.0, 2)*exp(2*a.error)/(pow(exp(a.error) + 1, 4)*(exp(a.freq) + 1.0)) - 0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 1.0*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(2*a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.333333333333333*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/(pow(exp(a.error) + 1, 3)*(exp(a.freq) + 1.0)) - 0.0555555555555556*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 4)*(exp(a.freq) + 1.0)) + 0.25*pow(M, 2)*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/(pow(1.0 - 0.5/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)*(exp(a.f) + 1.0)) - 0.166666666666667*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 4)*(exp(a.f) + 1.0)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) - 1.0*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 3)*(exp(a.f) + 1.0)) - 0.25*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/(pow(1.0 - 0.5/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)*(exp(a.f) + 1.0)) + 0.25*pow(m, 2)*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/(pow(1.0 - 0.5/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)) - 0.166666666666667*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 4)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) - 1.0*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 3)) - 0.25*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.error)/(pow(1.0 - 0.5/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.333333333333333*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(2*a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 3)*(exp(a.freq) + 1.0)) + 0.0277777777777778*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*pow(M + m, 2)*exp(2*a.error)/(pow(0.5 - 0.166666666666667/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)*(exp(a.freq) + 1.0)) - 0.0277777777777778*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(2*a.error)/(pow(0.5 - 0.166666666666667/(exp(a.error) + 1), 2)*pow(exp(a.error) + 1, 4)*(exp(a.freq) + 1.0)) + 0.0277777777777778*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*pow(E + M, 2)*pow(6.0*exp(a.error) + 6.0, 2)*exp(2*a.error)/pow(exp(a.error) + 1, 4) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*exp(2*a.error)/pow(exp(a.error) + 1, 2) + 0.333333333333333*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/pow(exp(a.error) + 1, 3) + 0.0277777777777778*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*pow(E + m, 2)*pow(6.0*exp(a.error) + 6.0, 2)*exp(2*a.error)/(pow(exp(a.error) + 1, 4)*(exp(a.f) + 1.0)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*exp(2*a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) + 0.333333333333333*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(2*a.error)/(pow(exp(a.error) + 1, 3)*(exp(a.f) + 1.0)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0)) + (-0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))*(0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) - 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2)
;
}

inline float_t J12 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))*(-0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2) + (-0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)*exp(a.f)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)*exp(a.f)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.f)/(pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.f)/(pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t J20 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))*(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*exp(a.freq)/pow(exp(a.freq) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.freq)/((exp(a.f) + 1.0)*pow(exp(a.freq) + 1.0, 2)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2) + (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*exp(a.f)*exp(a.freq)/(pow(exp(a.f) + 1.0, 2)*pow(exp(a.freq) + 1.0, 2)) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*exp(a.f)*exp(a.freq)/(pow(exp(a.f) + 1.0, 2)*pow(exp(a.freq) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t J21 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))*(0.166666666666667*E*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) - 0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)) - 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)*(M + m)*exp(a.error)/((0.5 - 0.166666666666667/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*(exp(a.freq) + 1.0)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)/pow(exp(a.error) + 1, 2) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)/(pow(exp(a.error) + 1, 2)*(exp(a.f) + 1.0)))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2) + (-0.5*M*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)*exp(a.f)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) + 0.5*m*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.error)*exp(a.f)/((1.0 - 0.5/(exp(a.error) + 1))*pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) - 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + M)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.f)/(pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)) + 0.166666666666667*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*(E + m)*(6.0*exp(a.error) + 6.0)*exp(a.error)*exp(a.f)/(pow(exp(a.error) + 1, 2)*pow(exp(a.f) + 1.0, 2)))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t J22 (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return (-1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))*(1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2))/pow(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0), 2) + (1.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) - 2.0*pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.f)/pow(exp(a.f) + 1.0, 3) - 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(a.f)/pow(exp(a.f) + 1.0, 2) + 2.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))*exp(2*a.f)/pow(exp(a.f) + 1.0, 3))/(1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow(0.5 - 0.166666666666667/(exp(a.error) + 1), M + m)/(exp(a.freq) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow(1.0 - 0.5/(exp(a.error) + 1), m)*(1 - 1.0/(exp(a.f) + 1.0))*(1 - 1.0/(exp(a.freq) + 1.0)) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow(1.0 - 0.5/(exp(a.error) + 1), M)*(1 - 1.0/(exp(a.freq) + 1.0))/(exp(a.f) + 1.0))
;
}

inline float_t lnL_NR (const quartet_t &q, const allele_stat &a) {
	const float_t M=q.base[a.major];
	const float_t m=q.base[a.minor];
	const float_t E=q.base[a.e1]+q.base[a.e2];
	return log((1.0*pow(0.166666666666667/(exp(a.error) + 1), E)*pow((0.5*exp(a.error) + 0.333333333333333)/(exp(a.error) + 1), M + m)*(exp(a.f) + 1.0) + pow(0.166666666666667/(exp(a.error) + 1), E + M)*pow((1.0*exp(a.error) + 0.5)/(exp(a.error) + 1), m)*exp(a.f + a.freq) + 1.0*pow(0.166666666666667/(exp(a.error) + 1), E + m)*pow((1.0*exp(a.error) + 0.5)/(exp(a.error) + 1), M)*exp(a.freq))/((exp(a.f) + 1.0)*(exp(a.freq) + 1.0)))
;
}

